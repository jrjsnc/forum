<!DOCTYPE html>
<html>
<link rel="stylesheet" href="css/login.css"/>
<head>
<meta charset="UTF-8" />
<title>Movie forum</title>
</head>
<body>
	
	<div class="container3">
	
			<span th:replace="fragments::header"></span>	
			<br/>
			
			<div class="indexForm">
			
			<form th:action='${"/filterTopics"}'>	
					<select th:name= "ident" th:onechane='${"/filterTopics"}' value="select topic">

						<option th:each="tag : ${tags}" th:value="${tag.ident}"
							th:text="${tag.getName()}" />
							<option th:value="-1" selected="true">all</option>
						
					</select>					
					<button type="submit" value="Select topics">Select topic</button>
				</form> 
				
			</div>
			<br/>
			
				<table>
					<th>Topic</th>
	 				<th>Tags</th>
					<th>Comments</th>
					<th>UserImage</th>	
					
					
					<tr th:each="topic : ${topics}">

						<td><a th:href='${"/topic?ident=" +topic.ident}'><span
								th:text='${topic.title}' /></a></td>
								
 						<td> <span th:each="tag : ${topic.getTags()}" th:text="${tag.name}"/>
								</td>

						<td><span th:text='${topic.getComments().size()}' /></td>

						<td> <span
							th:text='${topic.getForumUser().getLogin()}' /> </td> 
								
							<td>
							
							<div class="imgUserName"> 
							
							<img class="imageIndex" width="40" height="40"
											th:src="*{@userController.decodeToImage(topic.getForumUser().getLogin())}"
											onerror="this.src='image/default.jpg';" />
											<div class="middle">
							<div class="text" th:text='${topic.getForumUser().getLogin()}'/>
									
											</div>
									
									</div>
									
							</td>
								
					</tr>

				</table>

				<div>

					<span th:if='${@userController.Logged}'> 
					<span th:if='${#strings.toString(@userController.loggedUser.restriction) == "ADMIN"}'>
							<a th:href='${"/admin"}'>admin</a>
					</span>
					</span>

				</div>

				<span th:if='${@userController.Logged}'>

					<form action="/addTopic" method="post">

						Add Topic: <input type="text" name="title"
							placeholder="Add topic here" required="required"/> <button type="submit"
							value="Post" > Post </button>
					</form>
				</span>
						
			<span th:replace="fragments::footer"></span>
			</div>
		
	
</body>
<script src="js/forum.js"/>
</html>